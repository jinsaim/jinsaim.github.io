<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📔 스쳐가는 날들</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .date-display {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .diary-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #ff6b6b;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        input[type="date"], input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input[type="date"]:focus, input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        textarea {
            resize: vertical;
            min-height: 150px;
        }

        .mood-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mood-btn {
            padding: 10px 15px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
        }

        .mood-btn.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .diary-list {
            margin-top: 30px;
        }

        .diary-item {
            background: white;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .diary-item:hover {
            transform: translateY(-2px);
        }

        .diary-date {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .diary-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .diary-mood {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .diary-content {
            color: #555;
            line-height: 1.6;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            float: right;
            margin-top: -30px;
        }

        .empty-state {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #ff6b6b;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📔 스쳐가는 날들</h1>
            <div class="date-display" id="currentDate"></div>
        </div>

        <div class="main-content">
            <!-- 통계 섹션 -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalDiaries">0</div>
                    <div class="stat-label">총 일기</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="thisMonthDiaries">0</div>
                    <div class="stat-label">이번 달</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="streakDays">0</div>
                    <div class="stat-label">연속 일기</div>
                </div>
            </div>

            <!-- 일기 작성 폼 -->
            <div class="diary-form">
                <h2>✏️ 오늘은</h2>
                <form id="diaryForm">
                    <div class="form-group">
                        <label for="diaryDate">날짜</label>
                        <input type="date" id="diaryDate" required>
                    </div>

                    <div class="form-group">
                        <label for="diaryTitle">제목</label>
                        <input type="text" id="diaryTitle" placeholder="오늘의 제목을 입력하세요" required>
                    </div>

                    <div class="form-group">
                        <label>기분은</label>
                        <div class="mood-selector">
                            <button type="button" class="mood-btn" data-mood="😊">😊 좋음</button>
                            <button type="button" class="mood-btn" data-mood="😐">😐 보통</button>
                            <button type="button" class="mood-btn" data-mood="😢">😢 슬픔</button>
                            <button type="button" class="mood-btn" data-mood="😡">😡 화남</button>
                            <button type="button" class="mood-btn" data-mood="🤔">🤔 생각</button>
                            <button type="button" class="mood-btn" data-mood="😴">😴 피곤</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="diaryContent">내용</label>
                        <textarea id="diaryContent" placeholder="오늘 있었던 일, 생각, 느낌을 자유롭게 적어보세요..." required></textarea>
                    </div>

                    <button type="submit" class="btn">💾 일기 저장</button>
                </form>
            </div>

            <!-- 검색 -->
            <input type="text" class="search-box" id="searchBox" placeholder="🔍 일기 검색...">

            <!-- 일기 목록 -->
            <div class="diary-list">
                <h2>📚 자꾸 적다보면</h2>
                <div id="diaryContainer">
                    <div class="empty-state">
                        <p>아직 작성된 일기가 없습니다.<br>첫 번째 일기를 작성해보세요! ✨</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let diaries = JSON.parse(localStorage.getItem('diaries')) || [];
        let selectedMood = '';

        // DOM 요소
        const diaryForm = document.getElementById('diaryForm');
        const diaryContainer = document.getElementById('diaryContainer');
        const searchBox = document.getElementById('searchBox');
        const currentDateEl = document.getElementById('currentDate');
        const diaryDateInput = document.getElementById('diaryDate');

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 현재 날짜 설정
            const today = new Date();
            currentDateEl.textContent = today.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            
            diaryDateInput.valueAsDate = today;
            
            // 기분 선택 이벤트
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedMood = this.dataset.mood;
                });
            });

            // 폼 제출 이벤트
            diaryForm.addEventListener('submit', saveDiary);

            // 검색 이벤트
            searchBox.addEventListener('input', searchDiaries);

            // 일기 목록 표시
            displayDiaries();
            updateStats();
        });

        // 일기 저장
        function saveDiary(e) {
            e.preventDefault();

            const diary = {
                id: Date.now(),
                date: document.getElementById('diaryDate').value,
                title: document.getElementById('diaryTitle').value,
                mood: selectedMood || '😊',
                content: document.getElementById('diaryContent').value,
                createdAt: new Date().toISOString()
            };

            // 같은 날짜 일기가 있는지 확인
            const existingIndex = diaries.findIndex(d => d.date === diary.date);
            if (existingIndex !== -1) {
                if (confirm('이미 해당 날짜의 일기가 있습니다. 덮어쓰시겠습니까?')) {
                    diaries[existingIndex] = diary;
                } else {
                    return;
                }
            } else {
                diaries.push(diary);
            }

            // 날짜순 정렬
            diaries.sort((a, b) => new Date(b.date) - new Date(a.date));

            // 로컬 스토리지에 저장
            localStorage.setItem('diaries', JSON.stringify(diaries));

            // 폼 초기화
            diaryForm.reset();
            document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
            selectedMood = '';
            diaryDateInput.valueAsDate = new Date();

            // 목록 업데이트
            displayDiaries();
            updateStats();

            alert('일기가 저장되었습니다! 📝');
        }

        // 일기 목록 표시
        function displayDiaries(filteredDiaries = null) {
            const diariesToShow = filteredDiaries || diaries;

            if (diariesToShow.length === 0) {
                diaryContainer.innerHTML = '<div class="empty-state"><p>일기가 없습니다. 첫 번째 일기를 작성해보세요! ✨</p></div>';
                return;
            }

            diaryContainer.innerHTML = diariesToShow.map(diary => `
                <div class="diary-item">
                    <button class="delete-btn" onclick="deleteDiary(${diary.id})">삭제</button>
                    <div class="diary-date">${new Date(diary.date).toLocaleDateString('ko-KR')}</div>
                    <div class="diary-title">${diary.title}</div>
                    <div class="diary-mood">${diary.mood}</div>
                    <div class="diary-content">${diary.content.replace(/\n/g, '<br>')}</div>
                </div>
            `).join('');
        }

        // 일기 삭제
        function deleteDiary(id) {
            if (confirm('정말 이 일기를 삭제하시겠습니까?')) {
                diaries = diaries.filter(diary => diary.id !== id);
                localStorage.setItem('diaries', JSON.stringify(diaries));
                displayDiaries();
                updateStats();
            }
        }

        // 일기 검색
        function searchDiaries() {
            const searchTerm = searchBox.value.toLowerCase();
            if (searchTerm === '') {
                displayDiaries();
                return;
            }

            const filtered = diaries.filter(diary => 
                diary.title.toLowerCase().includes(searchTerm) ||
                diary.content.toLowerCase().includes(searchTerm)
            );

            displayDiaries(filtered);
        }

        // 통계 업데이트
        function updateStats() {
            const totalDiariesEl = document.getElementById('totalDiaries');
            const thisMonthDiariesEl = document.getElementById('thisMonthDiaries');
            const streakDaysEl = document.getElementById('streakDays');

            // 총 일기 수
            totalDiariesEl.textContent = diaries.length;

            // 이번 달 일기 수
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const thisMonthCount = diaries.filter(diary => {
                const diaryDate = new Date(diary.date);
                return diaryDate.getMonth() === thisMonth && diaryDate.getFullYear() === thisYear;
            }).length;
            thisMonthDiariesEl.textContent = thisMonthCount;

            // 연속 일기 일수 (간단한 계산)
            let streak = 0;
            const sortedDates = diaries.map(d => d.date).sort().reverse();
            if (sortedDates.length > 0) {
                const today = new Date().toISOString().split('T')[0];
                if (sortedDates[0] === today || sortedDates[0] === getYesterday()) {
                    streak = 1;
                    for (let i = 1; i < sortedDates.length; i++) {
                        const prev = new Date(sortedDates[i-1]);
                        const curr = new Date(sortedDates[i]);
                        const diffTime = prev - curr;
                        const diffDays = diffTime / (1000 * 60 * 60 * 24);
                        if (diffDays === 1) {
                            streak++;
                        } else {
                            break;
                        }
                    }
                }
            }
            streakDaysEl.textContent = streak;
        }

        // 어제 날짜 구하기
        function getYesterday() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return yesterday.toISOString().split('T')[0];
        }
    </script>
</body>
</html>
