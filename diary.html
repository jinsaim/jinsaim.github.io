<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“” ìŠ¤ì³ê°€ëŠ” ë‚ ë“¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .date-display {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .diary-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #ff6b6b;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        input[type="date"], input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input[type="date"]:focus, input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        textarea {
            resize: vertical;
            min-height: 150px;
        }

        .mood-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .mood-btn {
            padding: 10px 15px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
        }

        .mood-btn.selected {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .diary-list {
            margin-top: 30px;
        }

        .diary-item {
            background: white;
            border: 1px solid #eee;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .diary-item:hover {
            transform: translateY(-2px);
        }

        .diary-date {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .diary-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .diary-mood {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .diary-content {
            color: #555;
            line-height: 1.6;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            float: right;
            margin-top: -30px;
        }

        .empty-state {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #ff6b6b;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“” ìŠ¤ì³ê°€ëŠ” ë‚ ë“¤</h1>
            <div class="date-display" id="currentDate"></div>
        </div>

        <div class="main-content">
            <!-- í†µê³„ ì„¹ì…˜ -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalDiaries">0</div>
                    <div class="stat-label">ì´ ì¼ê¸°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="thisMonthDiaries">0</div>
                    <div class="stat-label">ì´ë²ˆ ë‹¬</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="streakDays">0</div>
                    <div class="stat-label">ì—°ì† ì¼ê¸°</div>
                </div>
            </div>

            <!-- ì¼ê¸° ì‘ì„± í¼ -->
            <div class="diary-form">
                <h2>âœï¸ ì˜¤ëŠ˜ì€</h2>
                <form id="diaryForm">
                    <div class="form-group">
                        <label for="diaryDate">ë‚ ì§œ</label>
                        <input type="date" id="diaryDate" required>
                    </div>

                    <div class="form-group">
                        <label for="diaryTitle">ì œëª©</label>
                        <input type="text" id="diaryTitle" placeholder="ì˜¤ëŠ˜ì˜ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>

                    <div class="form-group">
                        <label>ê¸°ë¶„ì€</label>
                        <div class="mood-selector">
                            <button type="button" class="mood-btn" data-mood="ğŸ˜Š">ğŸ˜Š ì¢‹ìŒ</button>
                            <button type="button" class="mood-btn" data-mood="ğŸ˜">ğŸ˜ ë³´í†µ</button>
                            <button type="button" class="mood-btn" data-mood="ğŸ˜¢">ğŸ˜¢ ìŠ¬í””</button>
                            <button type="button" class="mood-btn" data-mood="ğŸ˜¡">ğŸ˜¡ í™”ë‚¨</button>
                            <button type="button" class="mood-btn" data-mood="ğŸ¤”">ğŸ¤” ìƒê°</button>
                            <button type="button" class="mood-btn" data-mood="ğŸ˜´">ğŸ˜´ í”¼ê³¤</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="diaryContent">ë‚´ìš©</label>
                        <textarea id="diaryContent" placeholder="ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼, ìƒê°, ëŠë‚Œì„ ììœ ë¡­ê²Œ ì ì–´ë³´ì„¸ìš”..." required></textarea>
                    </div>

                    <button type="submit" class="btn">ğŸ’¾ ì¼ê¸° ì €ì¥</button>
                </form>
            </div>

            <!-- ê²€ìƒ‰ -->
            <input type="text" class="search-box" id="searchBox" placeholder="ğŸ” ì¼ê¸° ê²€ìƒ‰...">

            <!-- ì¼ê¸° ëª©ë¡ -->
            <div class="diary-list">
                <h2>ğŸ“š ìê¾¸ ì ë‹¤ë³´ë©´</h2>
                <div id="diaryContainer">
                    <div class="empty-state">
                        <p>ì•„ì§ ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ì²« ë²ˆì§¸ ì¼ê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”! âœ¨</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let diaries = JSON.parse(localStorage.getItem('diaries')) || [];
        let selectedMood = '';

        // DOM ìš”ì†Œ
        const diaryForm = document.getElementById('diaryForm');
        const diaryContainer = document.getElementById('diaryContainer');
        const searchBox = document.getElementById('searchBox');
        const currentDateEl = document.getElementById('currentDate');
        const diaryDateInput = document.getElementById('diaryDate');

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // í˜„ì¬ ë‚ ì§œ ì„¤ì •
            const today = new Date();
            currentDateEl.textContent = today.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            
            diaryDateInput.valueAsDate = today;
            
            // ê¸°ë¶„ ì„ íƒ ì´ë²¤íŠ¸
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedMood = this.dataset.mood;
                });
            });

            // í¼ ì œì¶œ ì´ë²¤íŠ¸
            diaryForm.addEventListener('submit', saveDiary);

            // ê²€ìƒ‰ ì´ë²¤íŠ¸
            searchBox.addEventListener('input', searchDiaries);

            // ì¼ê¸° ëª©ë¡ í‘œì‹œ
            displayDiaries();
            updateStats();
        });

        // ì¼ê¸° ì €ì¥
        function saveDiary(e) {
            e.preventDefault();

            const diary = {
                id: Date.now(),
                date: document.getElementById('diaryDate').value,
                title: document.getElementById('diaryTitle').value,
                mood: selectedMood || 'ğŸ˜Š',
                content: document.getElementById('diaryContent').value,
                createdAt: new Date().toISOString()
            };

            // ê°™ì€ ë‚ ì§œ ì¼ê¸°ê°€ ìˆëŠ”ì§€ í™•ì¸
            const existingIndex = diaries.findIndex(d => d.date === diary.date);
            if (existingIndex !== -1) {
                if (confirm('ì´ë¯¸ í•´ë‹¹ ë‚ ì§œì˜ ì¼ê¸°ê°€ ìˆìŠµë‹ˆë‹¤. ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    diaries[existingIndex] = diary;
                } else {
                    return;
                }
            } else {
                diaries.push(diary);
            }

            // ë‚ ì§œìˆœ ì •ë ¬
            diaries.sort((a, b) => new Date(b.date) - new Date(a.date));

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            localStorage.setItem('diaries', JSON.stringify(diaries));

            // í¼ ì´ˆê¸°í™”
            diaryForm.reset();
            document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
            selectedMood = '';
            diaryDateInput.valueAsDate = new Date();

            // ëª©ë¡ ì—…ë°ì´íŠ¸
            displayDiaries();
            updateStats();

            alert('ì¼ê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“');
        }

        // ì¼ê¸° ëª©ë¡ í‘œì‹œ
        function displayDiaries(filteredDiaries = null) {
            const diariesToShow = filteredDiaries || diaries;

            if (diariesToShow.length === 0) {
                diaryContainer.innerHTML = '<div class="empty-state"><p>ì¼ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ì¼ê¸°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”! âœ¨</p></div>';
                return;
            }

            diaryContainer.innerHTML = diariesToShow.map(diary => `
                <div class="diary-item">
                    <button class="delete-btn" onclick="deleteDiary(${diary.id})">ì‚­ì œ</button>
                    <div class="diary-date">${new Date(diary.date).toLocaleDateString('ko-KR')}</div>
                    <div class="diary-title">${diary.title}</div>
                    <div class="diary-mood">${diary.mood}</div>
                    <div class="diary-content">${diary.content.replace(/\n/g, '<br>')}</div>
                </div>
            `).join('');
        }

        // ì¼ê¸° ì‚­ì œ
        function deleteDiary(id) {
            if (confirm('ì •ë§ ì´ ì¼ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                diaries = diaries.filter(diary => diary.id !== id);
                localStorage.setItem('diaries', JSON.stringify(diaries));
                displayDiaries();
                updateStats();
            }
        }

        // ì¼ê¸° ê²€ìƒ‰
        function searchDiaries() {
            const searchTerm = searchBox.value.toLowerCase();
            if (searchTerm === '') {
                displayDiaries();
                return;
            }

            const filtered = diaries.filter(diary => 
                diary.title.toLowerCase().includes(searchTerm) ||
                diary.content.toLowerCase().includes(searchTerm)
            );

            displayDiaries(filtered);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const totalDiariesEl = document.getElementById('totalDiaries');
            const thisMonthDiariesEl = document.getElementById('thisMonthDiaries');
            const streakDaysEl = document.getElementById('streakDays');

            // ì´ ì¼ê¸° ìˆ˜
            totalDiariesEl.textContent = diaries.length;

            // ì´ë²ˆ ë‹¬ ì¼ê¸° ìˆ˜
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const thisMonthCount = diaries.filter(diary => {
                const diaryDate = new Date(diary.date);
                return diaryDate.getMonth() === thisMonth && diaryDate.getFullYear() === thisYear;
            }).length;
            thisMonthDiariesEl.textContent = thisMonthCount;

            // ì—°ì† ì¼ê¸° ì¼ìˆ˜ (ê°„ë‹¨í•œ ê³„ì‚°)
            let streak = 0;
            const sortedDates = diaries.map(d => d.date).sort().reverse();
            if (sortedDates.length > 0) {
                const today = new Date().toISOString().split('T')[0];
                if (sortedDates[0] === today || sortedDates[0] === getYesterday()) {
                    streak = 1;
                    for (let i = 1; i < sortedDates.length; i++) {
                        const prev = new Date(sortedDates[i-1]);
                        const curr = new Date(sortedDates[i]);
                        const diffTime = prev - curr;
                        const diffDays = diffTime / (1000 * 60 * 60 * 24);
                        if (diffDays === 1) {
                            streak++;
                        } else {
                            break;
                        }
                    }
                }
            }
            streakDaysEl.textContent = streak;
        }

        // ì–´ì œ ë‚ ì§œ êµ¬í•˜ê¸°
        function getYesterday() {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return yesterday.toISOString().split('T')[0];
        }
    </script>
</body>
</html>
